# Malware_Detection

# Malware Detection (Random Forest – Static Analysis)

A CLI-based malware scanner using a **Random Forest** model trained on static file features.
The scanner **does not execute files** — only safe byte-level and PE structure analysis.

---

## Features
- Byte histogram (256)
- File entropy & size
- PE metadata (sections, imports, exports, resources, debug)
- Random Forest classifier
- Works with **any file path**

---

## Setup
```bash
pip install numpy scikit-learn joblib pefile
```
---

## Usage
```bash
python malware_scanner.py <path_to_file>
```
---

## Example
```bash
python malware_scanner.py C:\Windows\System32\notepad.exe
```
---

## Output
- SAFE → proceed with transfer / encryption
- MALWARE → transfer aborted / quarantined


Scanner
File Input
   ↓
File Type Detection
   ↓
Route to Appropriate Detector
   ↓
Risk Scoring Engine (Fusion Layer)
   ↓
SAFE / SUSPICIOUS / MALWARE
Detection Modules
1️ Script Detector (.py, .js, .ps1, .bat)

Uses behavioral profiling instead of simple keyword matching.

Analyzes:

Execution behavior (eval, exec, os.system, subprocess)

Network activity (http, requests, sockets)

Obfuscation patterns (base64 blobs, entropy anomalies)

Persistence attempts (registry/startup references)

Correlated behaviors increase risk score significantly.

2️ PDF Detector (.pdf)

Performs structural inspection by scanning for:

/JavaScript

/OpenAction

/Launch

Embedded files

High entropy streams

Risk increases when multiple suspicious structures are present.

3️ Anomaly Detector (Unknown Files)

Applies statistical profiling:

Shannon entropy analysis

Byte distribution anomaly detection

File size irregularities

Designed to detect packed or encrypted suspicious content.

4️ Risk Fusion Engine

All detectors return structured scoring output.

The central fusion engine:

Aggregates category scores

Applies behavioral correlation bonuses

Produces final classification:

SAFE

SUSPICIOUS

MALWARE

This ensures explainable and scalable decision-making.

